<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute various normalization methods on a count matrix — normalize_count_matrix • coriell</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute various normalization methods on a count matrix — normalize_count_matrix" />
<meta property="og:description" content="Given a matrix of gene counts and a grouping factor identifying the group
membership for each column calculate normalized expression values using a 
variety of gene expression normalization techniques." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coriell</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/RNA-seq-workflow.html">RNA-seq-workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute various normalization methods on a count matrix</h1>
    
    <div class="hidden name"><code>normalize_count_matrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a matrix of gene counts and a grouping factor identifying the group
membership for each column calculate normalized expression values using a 
variety of gene expression normalization techniques.</p>
    </div>

    <pre class="usage"><span class='fu'>normalize_count_matrix</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>groups</span>,
  filter <span class='op'>=</span> <span class='cn'>TRUE</span>,
  min_count <span class='op'>=</span> <span class='fl'>10</span>,
  min_total_count <span class='op'>=</span> <span class='fl'>15</span>,
  large_n <span class='op'>=</span> <span class='fl'>10</span>,
  min_prop <span class='op'>=</span> <span class='fl'>0.7</span>,
  ref_column <span class='op'>=</span> <span class='cn'>NULL</span>,
  log_ratio_trim <span class='op'>=</span> <span class='fl'>0.3</span>,
  sum_trim <span class='op'>=</span> <span class='fl'>0.05</span>,
  do_weighting <span class='op'>=</span> <span class='cn'>TRUE</span>,
  acutoff <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1e+10</span>,
  p <span class='op'>=</span> <span class='fl'>0.75</span>,
  n_sub <span class='op'>=</span> <span class='fl'>1000</span>,
  fit_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"parametric"</span>, <span class='st'>"local"</span>, <span class='st'>"mean"</span>, <span class='st'>"glmGamPoi"</span><span class='op'>)</span>,
  batch <span class='op'>=</span> <span class='cn'>NULL</span>,
  norm_factors <span class='op'>=</span> <span class='cn'>NULL</span>,
  window <span class='op'>=</span> <span class='fl'>0.05</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>SummarizedExperiment</code> object containing a counts assay with 
raw counts or a matrix with features as rows and samples as columns.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>a group level continuous or categorial covariate associated 
with each sample or column in the object. The order of <code>groups</code> 
must match the order of the columns in object.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>bool. Default = TRUE. Should the lowly expressed genes be removed
prior to normalization? Uses the <code>filterByExpr</code> function in the <code>edgeR</code>
package.</p></td>
    </tr>
    <tr>
      <th>min_count</th>
      <td><p>Passed to <code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>edgeR::filterByExpr</a></code> the minimum count required
for at least some samples. Default 10.</p></td>
    </tr>
    <tr>
      <th>min_total_count</th>
      <td><p>Passed to <code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>edgeR::filterByExpr</a></code> the minimum total count
required. Default 15.</p></td>
    </tr>
    <tr>
      <th>large_n</th>
      <td><p>Passed to <code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>edgeR::filterByExpr</a></code> the number of samples per group
that is considered to be "large". Default 10.</p></td>
    </tr>
    <tr>
      <th>min_prop</th>
      <td><p>Passed to <code><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>edgeR::filterByExpr</a></code> the minimum proportion of samples
in the smallest group that express the gene. Default 0.7.</p></td>
    </tr>
    <tr>
      <th>ref_column</th>
      <td><p>Column to use as reference for method = "TMM". Can be a column 
number or a numeric vector of length nrow(object). Default = NULL. Used by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></td>
    </tr>
    <tr>
      <th>log_ratio_trim</th>
      <td><p>the fraction (0 to 0.5) of observations to be trimmed from 
each tail of the distribution of log-ratios (M-values) before computing the mean. 
Used by method="TMM" for each pair of samples. Default = 0.3. Used by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></td>
    </tr>
    <tr>
      <th>sum_trim</th>
      <td><p>the fraction (0 to 0.5) of observations to be trimmed from 
each tail of the distribution of A-values before computing the mean. 
Used by method="TMM" for each pair of samples. Default = 0.05. Used by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></td>
    </tr>
    <tr>
      <th>do_weighting</th>
      <td><p>logical, whether to use (asymptotic binomial precision) 
weights when computing the mean M-values. Used by method="TMM" for each pair 
of samples. Default = TRUE. Used by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></td>
    </tr>
    <tr>
      <th>acutoff</th>
      <td><p>minimum cutoff applied to A-values. Count pairs with lower 
A-values are ignored. Used by method="TMM" for each pair of samples. Default = -1e10.
Used by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>numeric value between 0 and 1 specifying which quantile of the counts 
should be used by method="upperquartile". Default = 0.75. Used by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></td>
    </tr>
    <tr>
      <th>n_sub</th>
      <td><p>the number of genes to subset. Default = 1000. Used by <code><a href='https://rdrr.io/pkg/DESeq2/man/vst.html'>DESeq2::vst</a></code></p></td>
    </tr>
    <tr>
      <th>fit_type</th>
      <td><p>either "parametric", "local", "mean", or "glmGamPoi" for the 
type of fitting of dispersions to the mean intensity. Used by <code><a href='https://rdrr.io/pkg/DESeq2/man/vst.html'>DESeq2::vst</a></code>. 
Default = "parametric"</p></td>
    </tr>
    <tr>
      <th>norm_factors</th>
      <td><p>optional normalization scaling factors. Used by <code><a href='https://rdrr.io/pkg/qsmooth/man/qsmooth.html'>qsmooth::qsmooth</a></code></p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>window size for running median which is a fraction of the 
number of rows in object. Default is 0.05. Used by <code><a href='https://rdrr.io/pkg/qsmooth/man/qsmooth.html'>qsmooth::qsmooth</a></code></p></td>
    </tr>
    <tr>
      <th>batch.</th>
      <td><p>(Optional) batch covariate (multiple batches are not allowed). 
If batch covariate is provided, Combat() from sva is used prior to qsmooth 
normalization to remove batch effects. See Combat() for more details. Used by
<code><a href='https://rdrr.io/pkg/qsmooth/man/qsmooth.html'>qsmooth::qsmooth</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List object with items containing matrices of normalized log count per million values
for each normalization method along with the original counts.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The following normalization methods are computed</p><ul>
<li><p>"TMM" Trimmed Mean of M-values computed by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></li>
<li><p>"RLE" Relative log expression computed by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></li>
<li><p>"UQ" Upper Quartile normalization computed by <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>edgeR::calcNormFactors</a></code></p></li>
<li><p>"VST" Variance Stabalizing Transformation computed by <code><a href='https://rdrr.io/pkg/DESeq2/man/vst.html'>DESeq2::vst</a></code></p></li>
<li><p>"RLog" Regularized Log transformation computed by <code><a href='https://rdrr.io/pkg/DESeq2/man/rlog.html'>DESeq2::rlog</a></code></p></li>
<li><p>"QSmooth" Smoothed Quantile Normalization computed by <code><a href='https://rdrr.io/pkg/qsmooth/man/qsmooth.html'>qsmooth::qsmooth</a></code></p></li>
<li><p>"Total Count" Library Size Normalization only</p></li>
</ul>

<p>The function returns a list with the log count per million normalized values 
for each of the above methods. The log2 scaled original counts are also returned.
For all methods except <code>vst</code> and <code>rlog</code> a pseudocount of 2 is added
to avoid taking logs of 0.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gennaro Calendo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


