<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function provides a wrapper around umap::umap() that exposes
the umap defaults as function arguments."><title>Perform UMAP — UMAP • coriell</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform UMAP — UMAP"><meta property="og:description" content="This function provides a wrapper around umap::umap() that exposes
the umap defaults as function arguments."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">coriell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Practical-analysis-with-SummarizedExperiments.html">Practical analysis with SummarizedExperiments</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/coriell-research/coriell/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Perform UMAP</h1>
      <small class="dont-index">Source: <a href="https://github.com/coriell-research/coriell/blob/HEAD/R/dim-reduction.R" class="external-link"><code>R/dim-reduction.R</code></a></small>
      <div class="d-none name"><code>UMAP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides a wrapper around <code><a href="https://rdrr.io/pkg/umap/man/umap.html" class="external-link">umap::umap()</a></code> that exposes
the umap defaults as function arguments.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">UMAP</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for pca</span></span>
<span><span class="fu">UMAP</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  n_neighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  n_epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  input <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"spectral"</span>,</span>
<span>  min_dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  set_op_mix_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  local_connectivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  negative_sample_rate <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  b <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  spread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  random_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  transform_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn_repeats <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  umap_learn_args <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for prcomp</span></span>
<span><span class="fu">UMAP</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_neighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  n_epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  input <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"spectral"</span>,</span>
<span>  min_dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  set_op_mix_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  local_connectivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  negative_sample_rate <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  b <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  spread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  random_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  transform_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn_repeats <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  umap_learn_args <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">UMAP</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_neighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  n_epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  input <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"spectral"</span>,</span>
<span>  min_dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  set_op_mix_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  local_connectivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  negative_sample_rate <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  b <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  spread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  random_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  transform_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn_repeats <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  umap_learn_args <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">UMAP</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_neighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  n_epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  input <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"spectral"</span>,</span>
<span>  min_dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  set_op_mix_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  local_connectivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  negative_sample_rate <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  b <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  spread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  random_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  transform_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn_repeats <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  umap_learn_args <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for dist</span></span>
<span><span class="fu">UMAP</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_neighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  n_epochs <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  input <span class="op">=</span> <span class="st">"dist"</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"spectral"</span>,</span>
<span>  min_dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  set_op_mix_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  local_connectivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bandwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  negative_sample_rate <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  b <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  spread <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  random_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  transform_state <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  knn_repeats <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  umap_learn_args <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>PCA object, prcomp object, or numeric matrix/data.frame that can be
converted to a numeric matrix</p></dd>


<dt>n_neighbors</dt>
<dd><p>Number of nearest neighbors. Default 15</p></dd>


<dt>n_components</dt>
<dd><p>Dimension of target (output) space. Default 2</p></dd>


<dt>metric</dt>
<dd><p>character or function; determines how distances between data
points are computed. When using a string, available metrics are: euclidean,
manhattan. Other available generalized metrics are: cosine, pearson,
pearson2. Note the triangle inequality may not be satisfied by some
generalized metrics, hence knn search may not be optimal. When using
metric.function as a function, the signature must be function(matrix,
origin, target) and should compute a distance between the origin column and
the target columns. Default "euclidean"</p></dd>


<dt>n_epochs</dt>
<dd><p>Number of iterations performed during layout optimization.
Default 200</p></dd>


<dt>input</dt>
<dd><p>character, use either "data" or "dist"; determines whether the
primary input argument to umap() is treated as a data matrix or as a
distance matrix. Default "data"</p></dd>


<dt>init</dt>
<dd><p>character or matrix. The default string "spectral" computes an
initial embedding using eigenvectors of the connectivity graph matrix. An
alternative is the string "random", which creates an initial layout based on
random coordinates. This setting.can also be set to a matrix, in which case
layout optimization begins from the provided coordinates. Default "spectral"</p></dd>


<dt>min_dist</dt>
<dd><p>numeric; determines how close points appear in the final
layout. Default 0.1</p></dd>


<dt>set_op_mix_ratio</dt>
<dd><p>numeric in range [0,1]; determines who the knn-graph
is used to create a fuzzy simplicial graph. Default 1</p></dd>


<dt>local_connectivity</dt>
<dd><p>numeric; used during construction of fuzzy
simplicial set. Default 1</p></dd>


<dt>bandwidth</dt>
<dd><p>numeric; used during construction of fuzzy simplicial set.
Default 1</p></dd>


<dt>alpha</dt>
<dd><p>numeric; initial value of "learning rate" of layout optimization.
Default 1</p></dd>


<dt>gamma</dt>
<dd><p>numeric; determines, together with alpha, the learning rate of
layout optimization. Default 1</p></dd>


<dt>negative_sample_rate</dt>
<dd><p>integer; determines how many non-neighbor
points are used per point and per iteration during layout optimization.
Default 5</p></dd>


<dt>a</dt>
<dd><p>numeric; contributes to gradient calculations during layout
optimization. When left at NA, a suitable value will be estimated
automatically. Default NA</p></dd>


<dt>b</dt>
<dd><p>numeric; contributes to gradient calculations during layout
optimization. When left at NA, a suitable value will be estimated
automatically. Default NA</p></dd>


<dt>spread</dt>
<dd><p>numeric; used during automatic estimation of a/b parameters.
Default 1</p></dd>


<dt>random_state</dt>
<dd><p>integer; seed for random number generation used during
umap(). Default NA</p></dd>


<dt>transform_state</dt>
<dd><p>nteger; seed for random number generation used
during predict(). Default NA</p></dd>


<dt>knn</dt>
<dd><p>object of class umap.knn; precomputed nearest neighbors. Default
NA</p></dd>


<dt>knn_repeats</dt>
<dd><p>number of times to restart knn search. Default 1</p></dd>


<dt>verbose</dt>
<dd><p>logical or integer; determines whether to show progress
messages. Default FALSE</p></dd>


<dt>umap_learn_args</dt>
<dd><p>vector of arguments to python package umap-learn.
Default NA</p></dd>


<dt>metadata</dt>
<dd><p>Optional data.frame with sample-level metadata. Used if a 
prcomp object or data.frame/matrix is supplied. Default NULL</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>data.frame with the UMAP embeddings. If metadata was supplied then 
metadata columns are added to the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create metadata for plotting</span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GSE161650_lc</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">metadata</span><span class="op">$</span><span class="va">Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DMSO"</span>, <span class="st">"THZ1"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PCA with PCAtools</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PCAtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PCAtools/man/pca.html" class="external-link">pca</a></span><span class="op">(</span><span class="va">GSE161650_lc</span>, <span class="va">metadata</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PCA with prcomp</span></span></span>
<span class="r-in"><span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">GSE161650_lc</span><span class="op">)</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pre-calculated distance matrix</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">GSE161650_lc</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform UMAP on each data type</span></span></span>
<span class="r-in"><span><span class="va">udata</span> <span class="op">&lt;-</span> <span class="fu">UMAP</span><span class="op">(</span><span class="va">p</span>, n_neighbors <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-in"><span><span class="va">udata2</span> <span class="op">&lt;-</span> <span class="fu">UMAP</span><span class="op">(</span><span class="va">pr</span>, <span class="va">metadata</span>, n_neighbors <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-in"><span><span class="va">udata3</span> <span class="op">&lt;-</span> <span class="fu">UMAP</span><span class="op">(</span><span class="va">d</span>, <span class="va">metadata</span>, n_neighbors <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Also on raw data</span></span></span>
<span class="r-in"><span><span class="va">udata4</span> <span class="op">&lt;-</span> <span class="fu">UMAP</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">GSE161650_lc</span><span class="op">)</span>, <span class="va">metadata</span>, n_neighbors <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>failed creating initial embedding; using random embedding instead</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gennaro Calendo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

