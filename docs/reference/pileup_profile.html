<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Return the pileup of reads over a set of GRanges — pileup_profile • coriell</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Return the pileup of reads over a set of GRanges — pileup_profile"><meta name="description" content="This function computes pileups for BAM files over a set of GRanges. It
returns pileup stats relative to the 5' to 3' direction taking strandedness
of the input range into account."><meta property="og:description" content="This function computes pileups for BAM files over a set of GRanges. It
returns pileup stats relative to the 5' to 3' direction taking strandedness
of the input range into account."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coriell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.16.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Practical-analysis-with-SummarizedExperiments.html">Practical analysis with SummarizedExperiments</a></li>
    <li><a class="dropdown-item" href="../articles/rnaseq-workflow.html">RNAseq Workflow</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/coriell-research/coriell/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Return the pileup of reads over a set of GRanges</h1>
      <small class="dont-index">Source: <a href="https://github.com/coriell-research/coriell/blob/HEAD/R/pileup-profile.R" class="external-link"><code>R/pileup-profile.R</code></a></small>
      <div class="d-none name"><code>pileup_profile.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes pileups for BAM files over a set of GRanges. It
returns pileup stats relative to the 5' to 3' direction taking strandedness
of the input range into account.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pileup_profile</span><span class="op">(</span></span>
<span>  <span class="va">bamfile</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">scan_bam_flag</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  min_base_quality <span class="op">=</span> <span class="fl">13</span>,</span>
<span>  min_mapq <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_nucleotide_depth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  summarize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bamfile">bamfile<a class="anchor" aria-label="anchor" href="#arg-bamfile"></a></dt>
<dd><p>Path to an indexed BAM file</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>GRanges to calculate pileups over</p></dd>


<dt id="arg-scan-bam-flag">scan_bam_flag<a class="anchor" aria-label="anchor" href="#arg-scan-bam-flag"></a></dt>
<dd><p>An instance of Rsamtools::scanBamFlag() used to to create
a parameter object influencing what fields and which records are imported
from a (binary) BAM file</p></dd>


<dt id="arg-max-depth">max_depth<a class="anchor" aria-label="anchor" href="#arg-max-depth"></a></dt>
<dd><p>maximum number of overlapping alignments considered
for each position in the pileup. See Rsamtools::PileupParam()</p></dd>


<dt id="arg-min-base-quality">min_base_quality<a class="anchor" aria-label="anchor" href="#arg-min-base-quality"></a></dt>
<dd><p>minimum ‘QUAL’ value for each nucleotide
in an alignment. Use phred2ASCIIOffset to help translate numeric or
character values to these offsets.</p></dd>


<dt id="arg-min-mapq">min_mapq<a class="anchor" aria-label="anchor" href="#arg-min-mapq"></a></dt>
<dd><p>minimum ‘MAPQ’ value for an alignment to be included
in pileup.</p></dd>


<dt id="arg-min-nucleotide-depth">min_nucleotide_depth<a class="anchor" aria-label="anchor" href="#arg-min-nucleotide-depth"></a></dt>
<dd><p>minimum count of each nucleotide
(independent of other nucleotides) at a given position required for said
nucleotide to appear in the result.</p></dd>


<dt id="arg-summarize">summarize<a class="anchor" aria-label="anchor" href="#arg-summarize"></a></dt>
<dd><p>Should the summary stats of the pileups at every relative
position over all ranges be returned? Default TRUE. If FALSE then a data.table
containing all measured ranges and relative positions is returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data.table</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For pileup computation, ranges are split by positive and negative strand
and positions in the final data.table are returned relative to the 5' start
in the input ranges. If unstranded ranges are supplied then they are treated
as positively stranded ranges.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select GRanges to compute pileups over</span></span></span>
<span class="r-in"><span><span class="va">gtf</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="st">"/path/to/annotation.gtf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">gtf</span><span class="op">[</span><span class="va">gtf</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"gene"</span> <span class="op">&amp;</span> <span class="va">gtf</span><span class="op">$</span><span class="va">gene_biotype</span> <span class="op">==</span> <span class="st">"protein_coding"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define parameters for reading in BAM files</span></span></span>
<span class="r-in"><span><span class="va">flags</span> <span class="op">&lt;-</span> <span class="fu">Rsamtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rsamtools/man/ScanBamParam-class.html" class="external-link">scanBamFlag</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  isPaired <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  isProperPair <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  isUnmappedQuery <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  hasUnmappedMate <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute pileups over all gene ranges  </span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">pileup_profile</span><span class="op">(</span><span class="st">"/path/to/sorted.bam"</span>, x <span class="op">=</span> <span class="va">genes</span>, scan_bam_flag <span class="op">=</span> <span class="va">flags</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gennaro Calendo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

